# **摘要：**

​    本文结合作者所参与研发的前台业务报表系统升级改造项目对如何设计信息系统的架构进行了论述。前台业务报表系统是国内某大型商业银行全行的通用报表平台，每日通过从各业务系统采集的数据进行报表展现，为该银行的决策者和经营管理人员提供各类系统交易的日报表信息平台。项目的主要内容是将原有的前台业务报表系统进行报表展现产品升级，对技术架构进行重构，对业务功能进行扩充，全面满足海内外的管理部门、业务部门对查看日趋复杂的大量的报表需求。 本文首先说明了作者在需求分析之后，软件设计之前为何重视架构设计的原因，并描述了通过分析本项目的规模、复杂程度、变化的因素等进行的新系统的架构设计。在此基础上依据具体的数据论述了作者采用的架构对于项目质量的效果。最后作者对本项目在架构设计的不足之处也做了简要分析，并提出了改进建议。

# 正文：

​    我在国内一家较大的商业银行的软件开发中心工作。由于我行前台业务报表从 99 年试点投产以来已经运行多年，其使用的报表产品版本对新操作系统的兼容等已经存在问题需要升级:原系统的技术架构及业务功能也已无法满足现今的业务报表要求。2021 年 2 月，总行规划并立项于 10 月前完成对业务报表进行改造，对使用的报表展现产品升级,对技术架构进行重构:根据日趋复杂的报表需求对业务功能进行扩充。我有幸参与了该项目并担任系统架构设计和项目管理工作。

​    本项目的主要任务是将国内前台业务报表和海外业务报表应用已有功能进行重构，实现境内外框架一体化，支持多语言与多时区，境内外分行均使用统一应用体系架构实现各业务类报表的处理、展现及打印功能;将国内版数据处理和存储集中在各个一级分行，海外版数据统一集中存放在海外数据中心;对使用的报表产品进行升级，采用 SAP 公司提供的 CRYSTAL 报表工具，完成报表体系架构的调整及报表程序的移行升级。 架构是信息系统的基石，对于信息系统项目的开发来说，一个清晰的架构是首要的，架构在软件需求与软件设计之间架起一座桥梁，着重解决软件系统的机构和需求向实现平坦地过渡的问题。架构在软件开发中为不同的人员提供了共同交流的语言，体现并尝试了系统早期的设计决策，并作为系统设计的抽象，为实现框架和构建的共享和重用、基于架构的软件开发提供了有力的支持。

​    本系统是一个系统改造项目，涉及国内 37 家分行，16 家境外机构，规模庞大而复杂，开发周期长，为保证项目质量，我们在需求分析之后，明确了本项目的开发任务，软件设计之前进行了详细的软件架构设计。 考虑到以下几点: 1、我行各分行及海外机构分布较散，另外随着 INTERNET 的迅速发展，部分报表信息需要通过网络向总行领导汇报展现: 2、各分行对数据查询速度要求高，每日各网点产生的数据量很大，要求每日报表在 10 秒内展现，并能进行批量打印: 3、银行内对数据的保密性要求高: 4、增强系统的可扩展性，并能访问若千年前的报表数据。

​    典型的软件架构风格有很多。例如，设计图形用户界面常用的事件驱动风格、设计操作系统常用的层次化设计风格，设计编译程序厂用电管道与过滤风格、设计分布式应用程序常用的客户机/服务器风格等。一个实用的软件系统通常是几种典型架构风格的组合。 经过分析，发现之前的前台业务报表系统C/S 模式体系结构已显示出了他在异构的、分布式的网络环境中的不足，可维护性和发布性等较差,并不利于系统扩展,难以满足新系统的要求,基于 B/S 体系的 WEB 应用有利于系统的扩展性维护性。C/S 一般建立在专用的网络上，小范围里的网络环境，局域网之间再通过专门服务器提供连接和数据交换服务。B/S 建立在广域网之上的， 不必是专门的网络硬件环境，有比 C/S 更强的适应范围， 一般只要有操作系统和浏览器就行:C/S 一般面向相对固定的用户群，对信息安全的控制能力很强。一般高度机密的信息系统采用 C/S 结构适宜。可以通过 B/S 发布部分可公开信息。B/S 建立在广域网之上，混合的架构设计。对安全的控制能力相对弱。结合 CS 和 BS 架构的优缺点，我们最终采用 C/S 和 B/S

​    一、系统支持分布式部署和集中式部署两种方式。 国内采用分布式部署方式，应用环境部署在各一级分行，数据库部署两个 0racle 实例。 海外采用集中式部署方式，应用环境部署在海外数据中数据库部署两个 Oracle 实例，两实例间通过 DBLINK 进行参数表的同步。 客户端程序国内部署心，于各二级分行、支行和网点: 海外部署于海外分行。

​    二、报表文件的生成: (1) 为减少传输的数据量，批量打印及离线归档采用文本方式，并且文本可以进行压缩传输，可有效减少网络传输流量。 (2) 所有报表数据文件都预生成，生成文本文件的批量服务器端进行自行开发，不依赖于报表工具产品，以根据数据本身的特色进行开发提高批量处理效率。例如采用 SQL 嵌入到 C 编程语言中，利用C 语言提高对文件处理的效率。 (3) 在批量服务器输出文件的同时,把相关的结果也写入到数据库的 B/S 查询表中供B/S 客户端查询展现,B/S查询表的数据库表的结构与批量打印使用的文本文件结构一致。

​    三、报表查看、批量打印部分:(1)  B/S 架构:报表查看结果的 HTML 页面由服务器生成，客户端本地不处理任何数据。对于 B/S 客户端方式，是一个纯集中式系统，数据的逻辑处理以及显示处理都是集中式的。对于 B/S 的报本查询需设立缓存机制。 (2 C/S 架构:是一个服务器与分布式结合的报表处理系统。服务器端主要工作是数据的逻辑处理，例如报表的汇总、统计、字典转换、币种折算、数据表关联等各类数据的逻辑处理。 四、版本在线自动更新功能: C/S 客户端提供版本在线自动更新功能。打开客户端程序后，客户端会根据临时文件来及更新日志记录自行检查是否与服务器版本号相符，若发现不符合，则客户端自行下载最新的版本，并自行安装新版本，解决网点的由于报表频繁升级的安装管理维护问题。

​    前台业务报表升级改造项目最终在 2021 年底投产并取得了较大的成功。完全符合海内外各分行及总行管理部门的需求，得到了大家一致好评。 当然，本项目的是存在一些不足之处的。我们在设计时将大部分的精力都放在了整体功能测试上，对于性能的设计上只考虑整体情况，较少考虑具体的数据库性能优化，例如表的索引设计以及锁事务处理机制我们有所忽略。导致投产后仍有少量交易因SQL 访问效率问题出现了响应时间过长的情况。这一点也是我们今后的项目设计中需要注意改进的地节。
